(***********************************************************************

                    Mathematica-Compatible Notebook

This notebook can be used on any computer system with Mathematica 3.0,
MathReader 3.0, or any compatible application. The data for the notebook 
starts with the line of stars above.

To get the notebook into a Mathematica-compatible application, do one of 
the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing the 
word CacheID, otherwise Mathematica-compatible applications may try to 
use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
***********************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     49568,       1436]*)
(*NotebookOutlinePosition[     50308,       1462]*)
(*  CellTagsIndexPosition[     50264,       1458]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["\<\
Recognition and Parsing 
of Context-Free Languages\
\>", "Title",
  TextAlignment->Center,
  TextJustification->0],

Cell[TextData[{
  StyleBox["\n\nby\n\n", "Author"],
  StyleBox["Jaime Rangel-Mondrag\[OAcute]n", "Author",
    FontSize->18,
    FontWeight->"Bold"],
  StyleBox["\n", "Author"],
  StyleBox["jrangel@sunserver.uaq.mx", "Reference",
    FontSize->16],
  StyleBox["\n", "Author"]
}], "Subtitle",
  TextAlignment->Center,
  TextJustification->0],

Cell[TextData[{
  StyleBox[
  "FACULTAD DE INFORM\[CapitalAAcute]TICA\nUNIVERSIDAD \
AUT\[CapitalOAcute]NOMA DE QUER\[CapitalEAcute]TARO\nDIVISI\[CapitalOAcute]N \
DE ESTUDIOS DE POSGRADO", "Reference",
    FontSize->16,
    FontWeight->"Bold"],
  StyleBox[
  "\nCentro Universitario\nCerro de las Campanas s/n\nC.P.76010 \
Quer\[EAcute]taro, Qro.\nMexico", "Reference",
    FontSize->16],
  StyleBox["\n\n", "Reference"],
  "\n",
  StyleBox[
  "Copyright \[Copyright] October 1999, UAQ, Facultad de Inform\[AAcute]tica\n\
\n", "Commentary"],
  StyleBox[
  "Permission is hereby granted to reproduce part or all of this file for any\
\n purpose other than direct profit providing that the source is \
acknowledged.",
    FontColor->RGBColor[0, 0, 1]]
}], "Abstract",
  CellMargins->{{Inherited, 45}, {Inherited, Inherited}},
  TextAlignment->Center,
  TextJustification->0],

Cell[TextData[{
  "REFERENCES:\t\n\n",
  StyleBox["Introduction to Formal Language Theory",
    FontWeight->"Bold"],
  "\nM. Harrison\nAddison-Wesley\n\n",
  StyleBox["Introduction to Automata, Languages andComputation",
    FontWeight->"Bold"],
  "\nJ. E. Hopcroft, J. D. Ullman\nAddison-Wesley\n\n",
  StyleBox["Introduction to Computer Theory",
    FontWeight->"Bold"],
  "\nD. I. A. Cohen\nJohn Wiley & Sons\n\n",
  StyleBox[
  "The Theory of Parsing, Translation and Compiling, Vol. I : Parsing",
    FontWeight->"Bold"],
  "\nA. V. Aho, J. D. Ullman\nPrentice Hall"
}], "Reference"],

Cell[CellGroupData[{

Cell["1 INTRODUCTION AND NOTATION", "Section 1"],

Cell[TextData[{
  "A context-free grammar (CFG) is denoted by a 4-tuple (V, T, P, S), where V \
and T are disjoint finite sets of ",
  StyleBox["variables",
    FontSlant->"Italic"],
  " and ",
  StyleBox["terminals",
    FontSlant->"Italic"],
  ", respectively.  P is a finite set of ",
  StyleBox["productions",
    FontSlant->"Italic"],
  " of the form A \[Rule] \[Alpha], where A \[Epsilon] V and \[Alpha] \
\[Epsilon] (V \[Union] T)* and S \[Epsilon] V is a special symbol called the \
",
  StyleBox["start symbol",
    FontSlant->"Italic"],
  ". The",
  StyleBox[" language generated",
    FontSlant->"Italic"],
  " by a given CFG G is defined as L(G)={\[Omega] | \[Omega] \[Epsilon] T* \
and S ",
  Cell[BoxData[
      \(TraditionalForm\`\(\[DoubleLongRightArrow]\&*\)\)]],
  " \[Omega]} where ",
  Cell[BoxData[
      \(TraditionalForm\`\(\[DoubleLongRightArrow]\&*\)\)]],
  " is the reflexive and transitive closure of \[Rule].\n\nIn this work we \
provide functions to manipulate the language generated by a given CFG G and \
solve the problem of ",
  StyleBox["recognition",
    FontSlant->"Italic"],
  ", i.e., to find out whether a given word \[Omega] \[Epsilon] L(G), and the \
problem of ",
  StyleBox["parsing",
    FontSlant->"Italic"],
  " a word that has been recognised, i.e., to find the actual chain of \
derivations giving rise to \[Omega].. We denote the empty word by \
\[CurlyEpsilon].\n\nVariables will be represented by upper-case letters and \
terminals by lower-case letters. A CFG will be represented by a list of \
productions {A, \[Alpha]}, that is, CFG are of type {{_String,_String}..}.\n\n\
Examples will follow each of the functions comprising this work. "
}], "Text"],

Cell[CellGroupData[{

Cell[TextData[{
  "We begin by designing functions to aliviate the input of CFG to be able to \
use the ",
  StyleBox["Backus-Naur form",
    FontSlant->"Italic"],
  "."
}], "Subsection"],

Cell[BoxData[
    \(dissect[w_] := 
      Module[{p = \ StringPosition[w, "\<|\>"], ans = {}, i = 1}, \n\t\t
        If[p == {}, {w}, \n\t\t\tp = First\ /@\ p; \n\t\t\t
          Map[\((AppendTo[ans, StringTake[w, {i, # - 1}]]; \n\t\t\t\t\t
                i = # + 1)\)&, p]; \n\t\t\t
          Append[ans, StringTake[w, {i, StringLength[w]}]]]]\)], "Input",
  InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
    \(dissect["\<ABC|DEF|a|\[CurlyEpsilon]|k|UV\>"]\)], "Input"],

Cell[BoxData[
    \({"ABC", "DEF", "a", "\[CurlyEpsilon]", "k", "UV"}\)], "Output"]
}, Closed]],

Cell[BoxData[
    \(BNF[G_] := 
      Module[{A, s, ans = {}}, \n\t\t
        Map[\((s = StringReplace[#, "\< \>" \[Rule] "\<\>"]; \n\t\t\t\t\t
              A = StringTake[s, 1]; \n\t\t\t\t
              AppendTo[ans, Thread[\({A, #}&\)[dissect[StringDrop[s, 2]]]]])
              \)&, G]; \n\t\t
        Flatten[ans, 1]\  /. \ "\<\[CurlyEpsilon]\>" \[Rule] "\<\>"]\)], 
  "Input",
  InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
    \(BNF[{"\<S \[Rule] SS|AA|b|\[CurlyEpsilon]\>", 
        "\<A \[Rule] AS|AA|BB|a\>", "\<B\[Rule]b\>"}]\)], "Input"],

Cell[BoxData[
    \({{"S", "SS"}, {"S", "AA"}, {"S", "b"}, {"S", ""}, {"A", "AS"}, {"A", 
        "AA"}, {"A", "BB"}, {"A", "a"}, {"B", "b"}}\)], "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["2 GRAMMARS AS LANGUAGE GENERATORS", "Section 1"],

Cell[CellGroupData[{

Cell["\<\
Given a word w and a single production {l, r}, we generate the set of all \
possible derivations.\
\>", "Subsection"],

Cell[BoxData[
    RowBox[{\(oneDerivation[w_String, {l_, r_}]\), ":=", 
      RowBox[{"Map", "[", 
        RowBox[{
          RowBox[{
            RowBox[{
              StyleBox["StringReplacePart",
                "MR"], 
              StyleBox["[",
                "MR"], 
              RowBox[{
                StyleBox["w",
                  "MR"], 
                StyleBox[",",
                  "MR"], " ", 
                StyleBox["r",
                  "MR"], 
                StyleBox[",",
                  "MR"], " ", "#"}], 
              StyleBox["]",
                "MR"]}], 
            StyleBox["&",
              "MR"]}], ",", \(StringPosition[w, l]\)}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(oneDerivation["\<SSSxSxxS\>", {"\<S\>", "\<ab\>"}]\)], "Input"],

Cell[BoxData[
    \({"abSSxSxxS", "SabSxSxxS", "SSabxSxxS", "SSSxabxxS", "SSSxSxxab"}\)], 
  "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
We generalize the above to a grammar acting on a set of words.\
\>", "Subsection"],

Cell[BoxData[
    \(oneDerivation[words : {_String..}, G_] := \t\t
      Flatten[Outer[List, words, G] /. 
          \ {{a_, b_}, {a_, c_}} \[Rule] oneDerivation[a, {b, c}]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(oneDerivation[{"\<SxSxS\>", "\<xSx\>", "\<SASx\>"}, 
      BNF[{"\<S\[Rule]Ay|\[CurlyEpsilon]\>", "\<A\[Rule]b\>"}]]\)], "Input"],

Cell[BoxData[
    \({"AyxSxS", "SxAyxS", "SxSxAy", "xSxS", "SxxS", "SxSx", "xAyx", "xx", 
      "AyASx", "SAAyx", "ASx", "SAx", "SbSx"}\)], "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
We further generalize to obtain all the words that can be generated by \
exactly n derivations and of size at most m. \
\>", "Subsection"],

Cell[BoxData[{
    \(words[G_, n_, m_] := Select[derivations[G, n, m], LowerCaseQ]\n\), 
    \(derivations[G_, n_, m_] := deriv[{"\<S\>"}, G, n, m]\n\t\), 
    \(deriv[{}, _, _, _] := {}\), 
    \(deriv[w_, _, 0, _] := w\n\), 
    \(deriv[w_, G_, n_, m_] := 
      Module[{d = oneDerivation[w, G], f}, \n\t\t
        f = Select[Union[d], StringLength[#] \[LessEqual] m&]; \n\t\t
        deriv[f, G, n - 1, m]]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Table[
      derivations[BNF[{"\<S\[Rule]aSa|bSb|a|b|\[CurlyEpsilon]\>"}], n, 5], {
        n, 3}]\)], "Input"],

Cell[BoxData[
    \({{"", "a", "aSa", "b", "bSb"}, {"aa", "aaa", "aaSaa", "aba", "abSba", 
        "bab", "baSab", "bb", "bbb", "bbSbb"}, {"aaaa", "aaaaa", "aabaa", 
        "ababa", "abba", "abbba", "baaab", "baab", "babab", "bbabb", "bbbb", 
        "bbbbb"}}\)], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Table[
      words[BNF[{"\<S\[Rule]aSa|bSb|a|b|\[CurlyEpsilon]\>"}], n, 5], {n, 4}]
      \)], "Input"],

Cell[BoxData[
    \({{"", "a", "b"}, {"aa", "aaa", "aba", "bab", "bb", "bbb"}, {"aaaa", 
        "aaaaa", "aabaa", "ababa", "abba", "abbba", "baaab", "baab", "babab", 
        "bbabb", "bbbb", "bbbbb"}, {}}\)], "Output"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["3 THE CKY ALGORITHM", "Section 1"],

Cell[TextData[{
  "The ",
  StyleBox["Cocke-Kasami-Younger algorithm",
    FontSlant->"Italic"],
  " requires grammars in ",
  StyleBox["Chomsky normal form",
    FontSlant->"Italic"],
  ", that is, \[CurlyEpsilon] \[NotElement] L(G) and each of its productions \
are of the form A \[Rule] BC or  A \[Rule] a. Any CFG G such that \
\[CurlyEpsilon] \[NotElement] L(G) possesses a Chomsky normal form.\n\nWe \
will neeed the auxiliary function yux below to yuxtapose sets of variables:"
}], "Text"],

Cell[BoxData[
    \(yux[B_, C_] := Flatten[Outer[StringJoin, B, C]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(yux[{"\<A\>", "\<B\>"}, {"\<C\>", "\<D\>", "\<E\>"}]\)], "Input"],

Cell[BoxData[
    \({"AC", "AD", "AE", "BC", "BD", "BE"}\)], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
  "Recognition through building the table t, t",
  Cell[BoxData[
      \(TraditionalForm\`\_\(i, j\)\)]],
  " contains the set of variables A such that A ",
  Cell[BoxData[
      \(TraditionalForm\`\(\(\[DoubleLongRightArrow]\ \)\&*\)\)]],
  "x",
  Cell[BoxData[
      \(TraditionalForm\`\(\ \_\(i, j\)\)\)]]
}], "Subsection"],

Cell[BoxData[
    \(CKY[w_, G_] := 
      Module[{A, t, n, x = Characters[w], f, i, j}, \n\t\t
        t = Map[{Cases[G, {A_, #} \[Rule] A]}&, x]; \n\t\tn = Length[x]; \n
        \t\tDo[\n\t\t\t
          AppendTo[t\[LeftDoubleBracket]i\[RightDoubleBracket], 
            Union[Flatten[
                Map[\n\t\t\t\t
                  \((f = yux[t\[LeftDoubleBracket]i, #\[RightDoubleBracket], 
                          t\[LeftDoubleBracket]i + #, 
                            j + 1 - #\[RightDoubleBracket]]; \n\t\t\t\t\t
                      First\ /@\ Select[G, MemberQ[f, Last[#]]&]\n\t\t\t\t)
                      \)&, Range[j]]]]]\n\t\t\t, {j, n}, {i, n - j}]; \n\t\tt]
        \)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(G\_1 = BNF[{"\<S \[Rule] SS|AA|b\>", "\<A \[Rule] AS|AA|a\>"}]; \n
    w\_1 = "\<aabb\>"; \nMatrixForm[CKY[w\_1, G\_1]]\)], "Input"],

Cell[BoxData[
    InterpretationBox[
      RowBox[{"(", GridBox[{
            {\({{"A"}, {"A", "S"}, {"A", "S"}, {"A", "S"}}\)},
            {\({{"A"}, {"A"}, {"A"}}\)},
            {\({{"S"}, {"S"}}\)},
            {\({{"S"}}\)}
            }], ")"}],
      MatrixForm[
       {{{"A"}, {"A", "S"}, {"A", "S"}, {"A", "S"}}, {{"A"}, {"A"}, {"A"}}, {{
        "S"}, {"S"}}, {{"S"}}}]]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(G\_2 = 
      BNF[{"\<S \[Rule] AB|BC\>", "\<A \[Rule] BA|a\>", "\<B \[Rule] CC|b\>", 
          "\<C \[Rule] AB|a\>"}]; \nw\_2 = "\<baaba\>"; \n
    MatrixForm[CKY[w\_2, G\_2]]\)], "Input"],

Cell[BoxData[
    InterpretationBox[
      RowBox[{"(", GridBox[{
            {\({{"B"}, {"A", "S"}, {}, {}, {"A", "C", "S"}}\)},
            {\({{"A", "C"}, {"B"}, {"B"}, {"A", "C", "S"}}\)},
            {\({{"A", "C"}, {"C", "S"}, {"B"}}\)},
            {\({{"B"}, {"A", "S"}}\)},
            {\({{"A", "C"}}\)}
            }], ")"}],
      MatrixForm[
       {{{"B"}, {"A", "S"}, {}, {}, {"A", "C", "S"}}, {{"A", "C"}, {"B"}, {
        "B"}, {"A", "C", "S"}}, {{"A", "C"}, {"C", "S"}, {"B"}}, {{"B"}, {"A",
         "S"}}, {{"A", "C"}}}]]], "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
The following computes the left parsing we seek through the use of an \
auxiliary recursive function.\
\>", "Subsection"],

Cell[BoxData[
    \(parseCKY[w_, G_] := 
      Module[{V = CKY[w, G], parse}, \n\t\t\t\t\n
        parse[i_, i_, A_] := First[Position[G, {A, StringTake[w, {i, i}]}]]; 
        \nparse[i_, j_, A_] := 
          Module[{k, B, C, p, m}, \n\t\tk = i + 1; \n\t\t
            While[\n\t\t\t
              B = V\[LeftDoubleBracket]i, k - i\[RightDoubleBracket]; \n\t\t\t
              C = V\[LeftDoubleBracket]k, j - k + 1\[RightDoubleBracket]; \n
              \t\t\tp = 
                Select[G, 
                  \((\((First[#] == A)\)\  && \ MemberQ[yux[B, C], Last[#]])
                      \)&, 1]; \n\t\t\tp == {}, \(k++\)]; \n\t\tp = First[p]; 
            \n\t\tm = 
              \(Position[G, p]\)\[LeftDoubleBracket]1, 1
                \[RightDoubleBracket]; \n\t\t\n\t\t
            Join[{m}, parse[i, k - 1, StringTake[Last[p], 1]], 
              parse[k, j, StringTake[Last[p], \(-1\)]]]]; \n\t\n\t\t\t
        If[Not[MemberQ[Last[V\[LeftDoubleBracket]1\[RightDoubleBracket]], 
              "\<S\>"]], {}, parse[1, StringLength[w], "\<S\>"]]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(parseCKY[w\_1, G\_1]\)], "Input"],

Cell[BoxData[
    \({2, 6, 4, 6, 1, 3, 3}\)], "Output"]
}, Closed]],

Cell[TextData[{
  "As ",
  Cell[BoxData[
      \(TraditionalForm\`G\_1\)]],
  "= {{\"S\",\"SS\"},{\"S\",\"AA\"},{\"S\",\"b\"},{\"A\",\"AS\"},{\"A\",\"AA\"\
},{\"A\",\"a\"}}, the above implies the following sequence of left \
derivations:\n\n\t\t\tS, AA, aA, aAS, aaS, aaSS, aabS, aabb"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    \(parseCKY[w\_2, G\_2]\)], "Input"],

Cell[BoxData[
    \({2, 6, 7, 4, 5, 7, 4, 6, 8}\)], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(G\_3 = 
      BNF[{"\<S \[Rule] AC|BD|a|b|AA|BB\>", "\<A \[Rule] a\>", 
          "\<B \[Rule] b\>", "\<C \[Rule] SA\>", "\<D \[Rule] SB\>"}]; \n
    w\_3 = "\<aaaaaaaaaa\>"; \nTable[parseCKY[w\_3, G\_3]]\)], "Input"],

Cell[BoxData[
    \({1, 7, 9, 1, 7, 9, 1, 7, 9, 1, 7, 9, 5, 7, 7, 7, 7, 7, 7}\)], "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["The following generates all palindromes of size n", "Subsection"],

Cell[BoxData[{
    \(pal[1] := {"\<a\>", "\<b\>"}\), 
    \(pal[2] := {"\<aa\>", "\<bb\>"}\), 
    \(pal[n_] := 
      Module[{p = pal[n - 2]}, \n\t\t
        Join[Map[\(("\<a\>"<>#<>"\<a\>")\)&, p], 
          Map[\(("\<b\>"<>#<>"\<b\>")\)&, p]]]\)}], "Input"],

Cell["We can examine all their parsings:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Map[{#, Timing[parseCKY[#, G\_3]]}&, pal[6]]\)], "Input"],

Cell[BoxData[
    \({{"aaaaaa", {
          0.159999999999999253`\ Second, {1, 7, 9, 1, 7, 9, 5, 7, 7, 7, 
            7}}}, {"aabbaa", {
          0.169999999999999928`\ Second, {1, 7, 9, 1, 7, 9, 6, 8, 8, 7, 
            7}}}, {"abaaba", {
          0.160000000000000142`\ Second, {1, 7, 9, 2, 8, 10, 5, 7, 7, 8, 
            7}}}, {"abbbba", {
          0.169999999999999928`\ Second, {1, 7, 9, 2, 8, 10, 6, 8, 8, 8, 
            7}}}, {"baaaab", {
          0.220000000000000639`\ Second, {2, 8, 10, 1, 7, 9, 5, 7, 7, 7, 
            8}}}, {"babbab", {
          0.159999999999999253`\ Second, {2, 8, 10, 1, 7, 9, 6, 8, 8, 7, 
            8}}}, {"bbaabb", {
          0.170000000000000817`\ Second, {2, 8, 10, 2, 8, 10, 5, 7, 7, 8, 
            8}}}, {"bbbbbb", {
          0.159999999999999253`\ Second, {2, 8, 10, 2, 8, 10, 6, 8, 8, 8, 
            8}}}}\)], "Output"]
}, Closed]],

Cell[TextData[{
  "Productions 3 and 4 are missing, hence we can afford to delete them from ",
  
  Cell[BoxData[
      \(TraditionalForm\`G\_3\)]],
  "; their only purpose is to be able to parse pal[1].\nAll of the above \
parsings start as 1, 7, 9 if  the corresponding palindrome begins with an \"a\
\" or 2, 8, 10 if  it begins with a \"b\".Also, all have the same length."
}], "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Similarly, we can explore the grammar generating the set of all words in {a, \
b} having an even number of a\.b4s generated by the following grammar:\
\>", "Subsection"],

Cell[BoxData[
    \(\(G\_4 = 
      BNF[{"\<S \[Rule] AS|CS|AA|CA|DE|DD|b\>", "\<C \[Rule] b\>", 
          "\<B \[Rule] CB|b\>", "\<A \[Rule] DE|DD\>", "\<E \[Rule] BD\>", 
          "\<D \[Rule] a\>"}]; \)\)], "Input"],

Cell["That set can be generated by function evenA below:", "Text"],

Cell[BoxData[{
    \(oddA[1] := {"\<a\>"}\), 
    \(oddA[2] := {"\<ab\>", "\<ba\>"}\), 
    \(oddA[n_] := 
      Join[Map[\(("\<a\>"<>#)\)&, evenA[n - 1]], 
        Map[\(("\<b\>"<>#)\)&, oddA[n - 1]]]\n\), 
    \(evenA[1] := {"\<b\>"}\), 
    \(evenA[2] := {"\<aa\>", "\<bb\>"}\), 
    \(evenA[n_] := 
      Join[Map[\(("\<a\>"<>#)\)&, oddA[n - 1]], 
        Map[\(("\<b\>"<>#)\)&, evenA[n - 1]]]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(evenA[4]\)], "Input"],

Cell[BoxData[
    \({"aaaa", "aabb", "abab", "abba", "baab", "baba", "bbaa", "bbbb"}\)], 
  "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Map[{#, Timing[parseCKY[#, G\_4]]}&, evenA[6]]\)], "Input"],

Cell[BoxData[
    \({{"aaaaaa", {
          0.219999999999999751`\ Second, {1, 12, 14, 14, 1, 12, 14, 14, 6, 
            14, 14}}}, {
        "aaaabb", {
          0.169999999999999928`\ Second, {1, 12, 14, 14, 1, 12, 14, 14, 2, 8, 
            7}}}, {"aaabab", {
          0.219999999999999751`\ Second, {1, 12, 14, 14, 1, 11, 14, 13, 10, 
            14, 7}}}, {
        "aaabba", {
          0.220000000000000639`\ Second, {1, 12, 14, 14, 5, 14, 13, 9, 8, 10, 
            14}}}, {"aabaab", {
          0.159999999999999253`\ Second, {1, 12, 14, 14, 2, 8, 1, 12, 14, 14, 
            7}}}, {"aababa", {
          0.220000000000000639`\ Second, {1, 12, 14, 14, 2, 8, 5, 14, 13, 10, 
            14}}}, {"aabbaa", {
          0.219999999999998863`\ Second, {1, 12, 14, 14, 2, 8, 2, 8, 6, 14, 
            14}}}, {"aabbbb", {
          0.160000000000000142`\ Second, {1, 12, 14, 14, 2, 8, 2, 8, 2, 8, 
            7}}}, {"abaaab", {
          0.220000000000000639`\ Second, {1, 11, 14, 13, 10, 14, 1, 12, 14, 
            14, 7}}}, {
        "abaaba", {
          0.220000000000000639`\ Second, {1, 11, 14, 13, 10, 14, 5, 14, 13, 
            10, 14}}}, {
        "ababaa", {
          0.169999999999999928`\ Second, {1, 11, 14, 13, 10, 14, 2, 8, 6, 14, 
            14}}}, {"ababbb", {
          0.219999999999998863`\ Second, {1, 11, 14, 13, 10, 14, 2, 8, 2, 8, 
            7}}}, {"abbaaa", {
          0.220000000000000639`\ Second, {1, 11, 14, 13, 9, 8, 10, 14, 6, 14, 
            14}}}, {"abbabb", {
          0.220000000000000639`\ Second, {1, 11, 14, 13, 9, 8, 10, 14, 2, 8, 
            7}}}, {"abbbab", {
          0.219999999999998863`\ Second, {1, 11, 14, 13, 9, 8, 9, 8, 10, 14, 
            7}}}, {"abbbba", {
          0.220000000000000639`\ Second, {5, 14, 13, 9, 8, 9, 8, 9, 8, 10, 
            14}}}, {"baaaab", {
          0.160000000000000142`\ Second, {2, 8, 1, 12, 14, 14, 1, 12, 14, 14, 
            7}}}, {"baaaba", {
          0.219999999999998863`\ Second, {2, 8, 1, 12, 14, 14, 5, 14, 13, 10, 
            14}}}, {"baabaa", {
          0.220000000000000639`\ Second, {2, 8, 1, 12, 14, 14, 2, 8, 6, 14, 
            14}}}, {"baabbb", {
          0.169999999999999928`\ Second, {2, 8, 1, 12, 14, 14, 2, 8, 2, 8, 
            7}}}, {"babaaa", {
          0.220000000000000639`\ Second, {2, 8, 1, 11, 14, 13, 10, 14, 6, 14, 
            14}}}, {"bababb", {
          0.219999999999998863`\ Second, {2, 8, 1, 11, 14, 13, 10, 14, 2, 8, 
            7}}}, {
        "babbab", {
          0.210000000000000852`\ Second, {2, 8, 1, 11, 14, 13, 9, 8, 10, 14, 
            7}}}, {"babbba", {
          0.169999999999999928`\ Second, {2, 8, 5, 14, 13, 9, 8, 9, 8, 10, 
            14}}}, {"bbaaaa", {
          0.220000000000000639`\ Second, {2, 8, 2, 8, 1, 12, 14, 14, 6, 14, 
            14}}}, {"bbaabb", {
          0.219999999999998863`\ Second, {2, 8, 2, 8, 1, 12, 14, 14, 2, 8, 
            7}}}, {"bbabab", {
          0.160000000000000142`\ Second, {2, 8, 2, 8, 1, 11, 14, 13, 10, 14, 
            7}}}, {"bbabba", {
          0.220000000000000639`\ Second, {2, 8, 2, 8, 5, 14, 13, 9, 8, 10, 
            14}}}, {"bbbaab", {
          0.219999999999998863`\ Second, {2, 8, 2, 8, 2, 8, 1, 12, 14, 14, 
            7}}}, {"bbbaba", {
          0.170000000000001705`\ Second, {2, 8, 2, 8, 2, 8, 5, 14, 13, 10, 
            14}}}, {"bbbbaa", {
          0.219999999999998863`\ Second, {2, 8, 2, 8, 2, 8, 2, 8, 6, 14, 
            14}}}, {"bbbbbb", {
          0.220000000000000639`\ Second, {2, 8, 2, 8, 2, 8, 2, 8, 2, 8, 7}}}}
      \)], "Output"]
}, Closed]],

Cell["Note the characteristic parsing for abbbba", "Text"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["4 EARLEY\.b4S ALGORITHM", "Section 1"],

Cell[TextData[{
  "In this part we follow the section \"A Good Practical Algorithm\" in \
Harrison\.b4s book, where a version of Earley algorithm \\ispresented. This \
algorithm is the most practical, genarl context-free recognition and parsing \
algorithm. In general it is O(",
  Cell[BoxData[
      \(TraditionalForm\`n\^3\)]],
  "), but takes O(",
  Cell[BoxData[
      \(TraditionalForm\`n\^2\)]],
  ") on any unambiguous CFG and it is reported to be actually linear on a \
wide variety of useful grammars. We will utilize the following CFG to test \
this algorithm. "
}], "Text"],

Cell[BoxData[
    \(G\_1 = BNF[{"\<S \[Rule] aSa|bSb|a|b|\[CurlyEpsilon]\>"}]; \n
    G\_2 = BNF[{"\<S \[Rule] AB\>", "\<A \[Rule] \[CurlyEpsilon]\>", 
          "\<B \[Rule] CDC\>", "\<C \[Rule] \[CurlyEpsilon]\>", 
          "\<D \[Rule] a\>"}]; \nG\_3 = BNF[{"\<S \[Rule] S*S|S+S|a\>"}]; \n
    G\_4 = BNF[{"\<S \[Rule] ABC | CD\>", "\<A \[Rule] C\>", 
          "\<B \[Rule] DA | A\>", "\<C \[Rule] AB | \[CurlyEpsilon]\>", 
          "\<D \[Rule] a\>"}]; \n
    G\_5 = BNF[{"\<S \[Rule] aSb | \[CurlyEpsilon]\>"}]; \n
    G\_6 = BNF[{"\<S \[Rule] aB | bA\>", "\<A \[Rule] a | aS | bAA\>", 
          "\<B \[Rule] b | bS | aBB\>"}]; \)], "Input"],

Cell[CellGroupData[{

Cell[TextData[{
  "A) DETECTION OF NULLABLE VARIABLES\n\n\t\t\tnullV[G]={A | ",
  Cell[BoxData[
      \(TraditionalForm
      \`\(\(A\ \[DoubleLongRightArrow]\[CurlyEpsilon]\ \)\&*\)\)]],
  "}\n\t\t\t"
}], "Subsection"],

Cell[BoxData[
    \(nullV[G_] := 
      Module[{A, u, c, g, s, t}, \n\t\t
        t = FixedPoint[
            \((u = #; \ \n\t\t\t\t\tc = Cases[u, {A_, "\<\>"} \[Rule] A]; \n
                \t\t\t\t\ts = Thread[\ \(\((# \[Rule] "\<\>")\)&\)[c]]; \n
                \t\t\t\t\tg = Select[u, Not[MemberQ[c, First[#]]]&]; 
                Map[{First[#], StringReplace[Last[#], s]}&, g])\)&, G]; \n\t\t
        Complement[First\ /@\ G, First\ /@\ t]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(nullV[G\_1]\), 
    \(nullV[G\_2]\), 
    \(nullV[G\_3]\), 
    \(nullV[G\_4]\), 
    \(nullV[G\_5]\), 
    \(nullV[G\_6]\)}], "Input"],

Cell[BoxData[
    \({"S"}\)], "Output"],

Cell[BoxData[
    \({"A", "C"}\)], "Output"],

Cell[BoxData[
    \({}\)], "Output"],

Cell[BoxData[
    \({"A", "B", "C", "S"}\)], "Output"],

Cell[BoxData[
    \({"S"}\)], "Output"],

Cell[BoxData[
    \({}\)], "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
B) OPERATIONS ON A  SET Q OF DOTTED RULES AND A SET R OF VARIABLES\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[TextData[{
  "Definition. If A \[Rule] \[Alpha]\[Beta] is a production, we say that A \
\[Rule] \[Alpha] \[FilledVerySmallSquare] \[Beta] is a dotted rule.\n\
Definition. Let Q be a set of dotted rules and R a set of variables:\n\n\t\t\t\
Q \[CircleTimes] R = { A \[Rule] \[Alpha]B\[Beta]\[FilledVerySmallSquare]\
\[Gamma] | A \[Rule] \[Alpha]\[FilledVerySmallSquare]B\[Beta]\[Gamma] is in \
Q, B\[Element]R and \[Beta]",
  Cell[BoxData[
      \(TraditionalForm\`\(\ 
      \(\(\[DoubleLongRightArrow]\&*\)\[CurlyEpsilon]\)\)\)]],
  "}\n\t\t\t"
}], "Subsubsection"],

Cell[BoxData[
    \(\((Q_\ \[CircleTimes]\ R_)\)\_G_ := 
      Module[{nV = nullV[G], q, r, i, j, ans = {}}, \n\t\t
        q = Cases[
            Q, {A_, {\[Alpha]___, "\<.\>", B_\  /; \ MemberQ[R, B], 
                  \[Beta]\[Gamma]___}}\  \[Rule] 
              \ {A, {\[Alpha], B, {\[Beta]\[Gamma]}}}]; \n\t\t
        Map[\((\n\t\t\t\tj = #; \ 
              PrependTo[
                j\[LeftDoubleBracket]\(-1\), \(-1\)\[RightDoubleBracket], 
                "\<.\>"]; \n\t\t\t\tAppendTo[ans, j]; \n\t\t\t\t
              r = #\[LeftDoubleBracket]\(-1\), \(-1\)\[RightDoubleBracket]; \n
              \t\t\t\ti = 1; \n\t\t\t\t
              While[\((i \[LessEqual] Length[r])\)\  && \ 
                  MemberQ[nV, r\[LeftDoubleBracket]i\[RightDoubleBracket]], \n
                \t\t\t\t\tj = #; \n\t\t\t\t\t
                j\[LeftDoubleBracket]\(-1\), \(-1\)\[RightDoubleBracket] = 
                  Insert[j\[LeftDoubleBracket]\(-1\), 
                      \(-1\)\[RightDoubleBracket], "\<.\>", i + 1]; \n
                \t\t\t\t\tAppendTo[ans, j]; \ \(i++\)]\n\t\t)\)&, q]; \n\t\t
        \({First[#], Flatten[Last[#]]}&\)\ /@\ ans]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(dl = BNF[{"\<S\[Rule]A.BCaB\>", "\<A\[Rule]D.CBS\>"}]\), 
    \(\((Map[{First[#], \ Characters[Last[#]]}&, dl]\[CircleTimes]{"\<B\>", 
            "\<C\>", "\<D\>", "\<B\>"})\)\_\(G\_4\)\)}], "Input"],

Cell[BoxData[
    \({{"S", "A.BCaB"}, {"A", "D.CBS"}}\)], "Output"],

Cell[BoxData[
    \({{"S", {"A", "B", ".", "C", "a", "B"}}, {
        "S", {"A", "B", "C", ".", "a", "B"}}, {
        "A", {"D", "C", ".", "B", "S"}}, {"A", {"D", "C", "B", ".", "S"}}, {
        "A", {"D", "C", "B", "S", "."}}}\)], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(({{"\<S\>", {"\<A\>", "\<.\>", "\<B\>"}}}\[CircleTimes]{"\<B\>"})
        \)\_\(G\_2\)\)], "Input"],

Cell[BoxData[
    \({{"S", {"A", "B", "."}}}\)], "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
  "C) COMPUTATION OF LEADERS\n\n Definition. leaders[R,G]={ B |  ",
  Cell[BoxData[
      \(TraditionalForm\`\(\(B\ \[DoubleLongRightArrow]C\ \)\&*\)\)]],
  " for some C\[Epsilon]R}\n\nleaders[R,G]=R \[Union] leaders[{H | H \[Rule] \
CBD for some B\[Epsilon]R and C,D \[Epsilon] (nullV[G])*, not both empty}, G]\
\n"
}], "Subsection"],

Cell[BoxData[{
    \(subsetQ[A_, a_] := \((Union[A, a] == Union[A])\)\n\t\), 
    \(leaders[R_, G_] := 
      Module[{h, nV = nullV[G], CBDForm}, \n\t\t\n\t\t
        CBDForm[{C___, B_\ , D___}] := 
          True\  /; \ MemberQ[R, B]\  && \ \ subsetQ[nV, {C, D}]; \n\t\t\t\t\t
        \n\t\th = Cases[G, {H_\ , k_\  /; CBDForm[Characters[k]]} \[Rule] H]; 
        \ \n\t\tIf[subsetQ[R, h], R, leaders[Union[R, h], G]]]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(leaders[{"\<D\>"}, G\_4]\)], "Input"],

Cell[BoxData[
    \({"A", "B", "C", "D", "S"}\)], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
  "Definition. Let Q be a set of dotted rules and R a set of variables:\n\n\t\
Q \[CircleDot] R\t = { A \[Rule] \[Alpha]B\[Beta]\[FilledVerySmallSquare]\
\[Gamma] | A \[Rule] \[Alpha]\[FilledVerySmallSquare]B\[Beta]\[Gamma] is in \
Q, B ",
  Cell[BoxData[
      \(TraditionalForm\`\(\ \(\[DoubleLongRightArrow]\&*\)\)\)]],
  " C for some C\[Epsilon]R and \[Beta]",
  Cell[BoxData[
      \(TraditionalForm\`\(\ 
      \(\(\[DoubleLongRightArrow]\&*\)\[CurlyEpsilon]\)\)\)]],
  "}\n\t\t=Q \[CircleTimes] leaders[R,G]\n\t\t"
}], "Subsubsection"],

Cell[BoxData[
    \(\((Q_\ \[CircleDot]\ R_)\)\_G_ := 
      \((Q\ \[CircleTimes]\ leaders[R, G])\)\_G\  /; 
        Length[Dimensions[R]] == 1\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(dl = BNF[{"\<S\[Rule]A.BCaB\>", "\<A\[Rule]D.CBS\>"}]\), 
    \(\((Map[{First[#], \ Characters[Last[#]]}&, dl]\[CircleDot]{"\<D\>"})
        \)\_\(G\_4\)\)}], "Input"],

Cell[BoxData[
    \({{"S", "A.BCaB"}, {"A", "D.CBS"}}\)], "Output"],

Cell[BoxData[
    \({{"S", {"A", "B", ".", "C", "a", "B"}}, {
        "S", {"A", "B", "C", ".", "a", "B"}}, {
        "A", {"D", "C", ".", "B", "S"}}, {"A", {"D", "C", "B", ".", "S"}}, {
        "A", {"D", "C", "B", "S", "."}}}\)], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(({{"\<S\>", {"\<A\>", "\<.\>", "\<B\>"}}}\[CircleDot]{"\<D\>"})
        \)\_\(G\_2\)\)], "Input"],

Cell[BoxData[
    \({{"S", {"A", "B", "."}}}\)], "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["D) EXTENSION TO BOTH Q AND R SETS OF DOTTED RULES", "Subsection"],

Cell[CellGroupData[{

Cell[TextData[{
  "Definition. ",
  Cell[BoxData[{
      RowBox[{
        RowBox[{\(Q\ \[CircleTimes]\ R\), " ", "=", " ", 
          RowBox[{
            RowBox[{"{", " ", 
              RowBox[{
              \(A\  \[Rule] \ 
                  \(\[Alpha]B\[Beta]\[FilledVerySmallSquare]\[Gamma]\  | \ A\ 
                     \[Rule] \ 
                    \[Alpha]\[FilledVerySmallSquare]B\[Beta]\[Gamma]\ is\ in\ 
                      Q\)\), ",", " ", 
                RowBox[{"B", "\[Rule]", 
                  RowBox[{"\[Eta]\[FilledVerySmallSquare]", "\[Element]", 
                    RowBox[{"R", " ", "and", " ", "\[Beta]", 
                      
                      FormBox[\(\ 
                        \(\(\[DoubleLongRightArrow]\&*\)\[CurlyEpsilon]\)\),
                        "TraditionalForm"]}]}]}]}], "}"}], "\n", "=", 
            \(Q\ \[CircleTimes]\ {
                B\  | \ B \[Rule] \[Eta]\[FilledVerySmallSquare] \[Element] R}
                \)}]}], "\n", "\t\t"}], 
      RowBox[{\(Q\ \[CircleDot]\ R\), " ", "=", " ", 
        RowBox[{
          RowBox[{"{", " ", 
            RowBox[{
            \(A\  \[Rule] \ 
                \(\[Alpha]B\[Beta]\[FilledVerySmallSquare]\[Gamma]\  | \ A\  
                  \[Rule] \ 
                  \[Alpha]\[FilledVerySmallSquare]B\[Beta]\[Gamma]\ is\ in\ Q
                    \)\), ",", " ", 
              RowBox[{
                RowBox[{"B", " ", 
                  FormBox[\(\ \(\[DoubleLongRightArrow]\&*\)\),
                    "TraditionalForm"], " ", "C", " ", "for", " ", "some", 
                  " ", "C", " ", "such", " ", "that", " ", "C"}], " ", 
                "\[Rule]", 
                RowBox[{
                "\[Eta]\[FilledVerySmallSquare]\[Epsilon]R", " ", "and", " ", 
                  "\[Beta]", 
                  
                  FormBox[\(\ 
                    \(\(\[DoubleLongRightArrow]\&*\)\[CurlyEpsilon]\)\),
                    "TraditionalForm"]}]}]}], "}"}], "\n", "=", 
          \(Q\ \[CircleDot]\ \ {
              C\  | \ C \[Rule] \[Eta]\[FilledVerySmallSquare] \[Element] R}
              \)}]}]}]],
  "\n"
}], "Subsubsection"],

Cell[BoxData[{
    \(\((Q_\ \[CircleTimes]\ R_)\)\_G_ := 
      \((Q\ \[CircleTimes]\ Cases[R, {A_, {___, "\<.\>"}}\  \[Rule] \ A])
            \)\_\(G\ \) /; Length[Dimensions[R]] > 1\n\), 
    \(\((Q_\ \[CircleDot]\ R_)\)\_G_ := 
      \((Q\ \[CircleDot]\ Cases[R, {A_, {___, "\<.\>"}} \[Rule] \ A])\)\_\(G\ 
          \) /; Length[Dimensions[R]] > 1\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(u = {{"\<S\>", {"\<.\>", "\<A\>", "\<B\>"}}, {"\<A\>", {"\<.\>"}}, {
          "\<B\>", {"\<.\>", "\<C\>", "\<D\>", "\<C\>"}}, {
          "\<C\>", {"\<.\>"}}, {"\<D\>", {"\<.\>", "\<a\>"}}, {
          "\<S\>", {"\<A\>", "\<.\>", "\<B\>"}}, {
          "\<B\>", {"\<C\>", "\<.\>", "\<D\>", "\<C\>"}}}; \n
    v = {{"\<D\>", {"\<a\>", "\<.\>"}}}; \n
    \((u\ \[CircleDot]\ v)\)\_\(G\_2\)\)], "Input"],

Cell[BoxData[
    \({{"S", {"A", "B", "."}}, {"B", {"C", "D", ".", "C"}}, {
        "B", {"C", "D", "C", "."}}}\)], "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["E) CONSTRUCTION OF THE PREDICTOR", "Subsection"],

Cell[CellGroupData[{

Cell[TextData[{
  "COMPUTATION OF FOLLOWERS\n\nDefinition.  followers[R,G]={ C |  ",
  Cell[BoxData[
      \(TraditionalForm\`\(\(B\ \[DoubleLongRightArrow]C\[Eta]\ \)\&*\)\)]],
  " for some B\[Epsilon]R and some \[Eta] \[Element]V*}\n\nfollowers[R,G]=R \
\[Union] followers[{H | B \[Rule] CHD for some B\[Epsilon]R and C,D \
\[Epsilon] (nullV[G])*, not both empty}, G]\n"
}], "Subsubsection"],

Cell[BoxData[{
    \(followers[{}, _] := {}\), 
    \(followers[R_, G_] := 
      Module[{g, h = {}, nV = nullV[G], carryOn}, \n\t\t\t\t\t\n\t\t
        g = Cases[
            G, {B_\ \  /; \ MemberQ[R, B], C_} \[Rule] {B, Characters[C]}]; \n
        \t\tMap[\((\n\t\t\ti = 1; \n\t\t\t\tcarryOn = True; \n\t\t\t\t
              While[carryOn\  && \ \((i \[LessEqual] Length[Last[#]])\)\  && 
                  UpperCaseQ[
                    \(Last[#]\)\[LeftDoubleBracket]i\[RightDoubleBracket]], \ 
                AppendTo[h, 
                  \(Last[#]\)\[LeftDoubleBracket]i\[RightDoubleBracket]]; \n
                \t\t\t\t\t
                If[Not[MemberQ[nV, 
                      \(Last[#]\)\[LeftDoubleBracket]i
                        \[RightDoubleBracket]]], carryOn = False]; \ \(i++\)]
                \n\t\t\t)\)&, g]; \ \n\t\t
        Union[R, followers[Complement[h, R], G]]]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(followers[{"\<S\>"}, G\_1]\), 
    \(followers[{"\<S\>"}, G\_2]\), 
    \(followers[{"\<S\>"}, G\_3]\), 
    \(followers[{"\<S\>"}, G\_4]\), 
    \(followers[{"\<S\>"}, G\_5]\), 
    \(followers[{"\<S\>"}, G\_6]\)}], "Input"],

Cell[BoxData[
    \({"S"}\)], "Output"],

Cell[BoxData[
    \({"A", "B", "C", "D", "S"}\)], "Output"],

Cell[BoxData[
    \({"S"}\)], "Output"],

Cell[BoxData[
    \({"A", "B", "C", "D", "S"}\)], "Output"],

Cell[BoxData[
    \({"S"}\)], "Output"],

Cell[BoxData[
    \({"S"}\)], "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
  "Definition.  \n\n\tpredict(R) = { C \[Rule] \[Gamma] \
\[FilledVerySmallSquare] \[Xi] | C \[Rule] \[Gamma] \[Xi] is a production, \
\[Gamma] ",
  Cell[BoxData[
      \(TraditionalForm\`\( \[DoubleRightArrow] \&*\)\)]],
  " \[CurlyEpsilon], B ",
  Cell[BoxData[
      \(TraditionalForm\`\( \[DoubleRightArrow] \&*\)\)]],
  " C \[Eta] for some B \[Epsilon] R and some \[Eta] \[Epsilon] V* }\n\t"
}], "Subsubsection"],

Cell[BoxData[
    \(predict[R_, G_] := 
      Module[{nV = nullV[G], f = followers[R, G], g, ans, i}, \ \n\t\t\n\t\t
        g = Cases[
            G, {C_\ \  /; \ MemberQ[f, C], \[Alpha]_} 
              \[Rule] {C, Characters[\[Alpha]]}]; \n\t\t
        ans = Map[{First[#], Join[{"\<.\>"}, Last[#]]}&, g]; \ \n\t\t
        Map[\((\n\t\t\ti = 1; \n\t\t\t\t
              While[\((i \[LessEqual] Length[Last[#]])\)\  && \ 
                  MemberQ[nV, 
                    \(Last[#]\)\[LeftDoubleBracket]i\[RightDoubleBracket]], 
                AppendTo[ans, {First[#], Insert[Last[#], "\<.\>", i + 1]}]; 
                \(i++\)]; \n\t\t\t)\)&, g]; \n\t\tans]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(predict[{"\<S\>"}, G\_1]\), 
    \(predict[{"\<S\>"}, G\_2]\), 
    \(predict[{"\<S\>"}, G\_3]\), 
    \(predict[{"\<S\>"}, G\_4]\), 
    \(predict[{"\<S\>"}, G\_5]\), 
    \(predict[{"\<S\>"}, G\_6]\)}], "Input"],

Cell[BoxData[
    \({{"S", {".", "a", "S", "a"}}, {"S", {".", "b", "S", "b"}}, {
        "S", {".", "a"}}, {"S", {".", "b"}}, {"S", {"."}}}\)], "Output"],

Cell[BoxData[
    \({{"S", {".", "A", "B"}}, {"A", {"."}}, {"B", {".", "C", "D", "C"}}, {
        "C", {"."}}, {"D", {".", "a"}}, {"S", {"A", ".", "B"}}, {
        "B", {"C", ".", "D", "C"}}}\)], "Output"],

Cell[BoxData[
    \({{"S", {".", "S", "*", "S"}}, {"S", {".", "S", "+", "S"}}, {
        "S", {".", "a"}}}\)], "Output"],

Cell[BoxData[
    \({{"S", {".", "A", "B", "C"}}, {"S", {".", "C", "D"}}, {
        "A", {".", "C"}}, {"B", {".", "D", "A"}}, {"B", {".", "A"}}, {
        "C", {".", "A", "B"}}, {"C", {"."}}, {"D", {".", "a"}}, {
        "S", {"A", ".", "B", "C"}}, {"S", {"A", "B", ".", "C"}}, {
        "S", {"A", "B", "C", "."}}, {"S", {"C", ".", "D"}}, {
        "A", {"C", "."}}, {"B", {"A", "."}}, {"C", {"A", ".", "B"}}, {
        "C", {"A", "B", "."}}}\)], "Output"],

Cell[BoxData[
    \({{"S", {".", "a", "S", "b"}}, {"S", {"."}}}\)], "Output"],

Cell[BoxData[
    \({{"S", {".", "a", "B"}}, {"S", {".", "b", "A"}}}\)], "Output"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[
" EXTENSION TO A SET OF DOTTED RULES\n\nDefinition.\n\t\t predict(R) \
=predict({ B | A \[Rule] \[Alpha] \[FilledVerySmallSquare] B\[Beta] is a \
production})\n\t\t "], "Subsubsection"],

Cell[BoxData[
    \(predict[R_, G_] := 
      predict[Cases[R, {_, {___, "\<.\>", B_, \[Beta]___}} \[Rule] B], G]\ \ 
         /; Length[Dimensions[R]] > 1\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(predict[{{"\<B\>", {"\<C\>", "\<D\>", "\<.\>", "\<C\>"}}, {
          "\<B\>", {"\<C\>", "\<D\>", "\<C\>", "\<.\>"}}, {
          "\<D\>", {"\<a\>", "\<.\>"}}, {
          "\<S\>", {"\<A\>", "\<B\>", "\<.\>"}}}, G\_2]\)], "Input"],

Cell[BoxData[
    \({{"C", {"."}}}\)], "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["F) MAIN ALGORITHM", "Subsection"],

Cell[CellGroupData[{

Cell["Construction of the parse matrix earley", "Subsubsection"],

Cell[BoxData[
    \(earley[w_, G_] := 
      Module[{n, i, j, k, t}, \n\t\tn = StringLength[w]; \n\t\t\n\t\t
        t = Table[{}, {i, n + 1}, {j, n + 1}]; \n\t\t\n\t\t
        t\[LeftDoubleBracket]1, 1\[RightDoubleBracket] = 
          predict[{"\<S\>"}, G]; \n\t\t
        Do[\n\t\t\t
          Do[\n\t\t\t\t
            t\[LeftDoubleBracket]i, j\[RightDoubleBracket] = 
              \((t\[LeftDoubleBracket]i, j - 1\[RightDoubleBracket]\ 
                    \[CircleTimes]\ {StringTake[w, {j - 1}]})\)\_G, {i, 
              j - 1}]; \n\t\t\t
          Do[\n\t\t\t\t
            t\[LeftDoubleBracket]k, j\[RightDoubleBracket] = 
              Union[t\[LeftDoubleBracket]k, j\[RightDoubleBracket], 
                \((t\[LeftDoubleBracket]k, k
                        \[RightDoubleBracket]\[CircleDot]\ 
                      t\[LeftDoubleBracket]k, j\[RightDoubleBracket])\)\_G]; 
            \n\t\t\t\t
            Do[\n\t\t\t\t\t
              t\[LeftDoubleBracket]i, j\[RightDoubleBracket] = 
                Union[t\[LeftDoubleBracket]i, j\[RightDoubleBracket], 
                  \((t\[LeftDoubleBracket]i, k\[RightDoubleBracket]\ 
                        \[CircleTimes]\ 
                        t\[LeftDoubleBracket]k, j\[RightDoubleBracket])
                      \)\_G], {i, k - 1, 1, \(-1\)}], {k, j - 1, 1, \(-1\)}]; 
          \n\t\t\tt\[LeftDoubleBracket]j, j\[RightDoubleBracket] = 
            predict[Union\ \ @@\ 
                Table[t\[LeftDoubleBracket]i, j\[RightDoubleBracket], {i, 
                    j - 1}], G], {j, 2, n + 1}]; \n\t\tt]\)], "Input"],

Cell["\<\
To aid in the formatting of the output we make use of function \
showDottedPairs below:\
\>", "Text"],

Cell[BoxData[{
    \(showDottedPairs[{}] := {"\<\>"}\), 
    \(showDottedPairs[{A_, B_}] := A<>"\<\[Rule]\>"<>StringJoin[B]\)}], 
  "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(e\_2 = earley["\<a\>", G\_2]; \n
    Table[If[e\_2\[LeftDoubleBracket]i, j\[RightDoubleBracket] 
            \[NotEqual] {}, 
          Map[showDottedPairs, 
              e\_2\[LeftDoubleBracket]i, j\[RightDoubleBracket]]\  // \ 
            MatrixForm, {"\<\>"}], {i, 2}, {j, 2}]\ \  // \ MatrixForm\)], 
  "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", GridBox[{
            {
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule].AB"\)},
                      {\("A\[Rule]."\)},
                      {\("B\[Rule].CDC"\)},
                      {\("C\[Rule]."\)},
                      {\("D\[Rule].a"\)},
                      {\("S\[Rule]A.B"\)},
                      {\("B\[Rule]C.DC"\)}
                      }], ")"}],
                MatrixForm[
                 {"S\[Rule].AB", "A\[Rule].", "B\[Rule].CDC", "C\[Rule].", 
                  "D\[Rule].a", "S\[Rule]A.B", "B\[Rule]C.DC"}]], 
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("B\[Rule]CD.C"\)},
                      {\("B\[Rule]CDC."\)},
                      {\("D\[Rule]a."\)},
                      {\("S\[Rule]AB."\)}
                      }], ")"}],
                MatrixForm[
                 {"B\[Rule]CD.C", "B\[Rule]CDC.", "D\[Rule]a.", 
                  "S\[Rule]AB."}]]},
            {\({""}\), 
              InterpretationBox[\(("C\[Rule].")\),
                MatrixForm[ {"C\[Rule]."}]]}
            }], ")"}],
      (MatrixForm[ #]&)]], "Output"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
    \(e\_3 = earley["\<a+a*a\>", G\_3]; \n
    Table[If[e\_3\[LeftDoubleBracket]i, j\[RightDoubleBracket] 
            \[NotEqual] {}, 
          Map[showDottedPairs, 
              e\_3\[LeftDoubleBracket]i, j\[RightDoubleBracket]]\  // \ 
            MatrixForm, {"\<\>"}], {i, 6}, {j, 6}]\ \  // \ MatrixForm\)], 
  "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", GridBox[{
            {
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule].S*S"\)},
                      {\("S\[Rule].S+S"\)},
                      {\("S\[Rule].a"\)}
                      }], ")"}],
                MatrixForm[ {"S\[Rule].S*S", "S\[Rule].S+S", "S\[Rule].a"}]], 
              
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule]a."\)},
                      {\("S\[Rule]S.*S"\)},
                      {\("S\[Rule]S.+S"\)}
                      }], ")"}],
                MatrixForm[ {"S\[Rule]a.", "S\[Rule]S.*S", "S\[Rule]S.+S"}]], 
              
              InterpretationBox[\(("S\[Rule]S+.S")\),
                MatrixForm[ {"S\[Rule]S+.S"}]], 
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule]S+S."\)},
                      {\("S\[Rule]S.*S"\)},
                      {\("S\[Rule]S.+S"\)}
                      }], ")"}],
                MatrixForm[
                 {"S\[Rule]S+S.", "S\[Rule]S.*S", "S\[Rule]S.+S"}]], 
              InterpretationBox[\(("S\[Rule]S*.S")\),
                MatrixForm[ {"S\[Rule]S*.S"}]], 
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule]S*S."\)},
                      {\("S\[Rule]S+S."\)},
                      {\("S\[Rule]S.*S"\)},
                      {\("S\[Rule]S.+S"\)}
                      }], ")"}],
                MatrixForm[
                 {"S\[Rule]S*S.", "S\[Rule]S+S.", "S\[Rule]S.*S", 
                  "S\[Rule]S.+S"}]]},
            {\({""}\), \({""}\), \({""}\), \({""}\), \({""}\), \({""}\)},
            {\({""}\), \({""}\), 
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule].S*S"\)},
                      {\("S\[Rule].S+S"\)},
                      {\("S\[Rule].a"\)}
                      }], ")"}],
                MatrixForm[ {"S\[Rule].S*S", "S\[Rule].S+S", "S\[Rule].a"}]], 
              
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule]a."\)},
                      {\("S\[Rule]S.*S"\)},
                      {\("S\[Rule]S.+S"\)}
                      }], ")"}],
                MatrixForm[ {"S\[Rule]a.", "S\[Rule]S.*S", "S\[Rule]S.+S"}]], 
              
              InterpretationBox[\(("S\[Rule]S*.S")\),
                MatrixForm[ {"S\[Rule]S*.S"}]], 
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule]S*S."\)},
                      {\("S\[Rule]S.*S"\)},
                      {\("S\[Rule]S.+S"\)}
                      }], ")"}],
                MatrixForm[
                 {"S\[Rule]S*S.", "S\[Rule]S.*S", "S\[Rule]S.+S"}]]},
            {\({""}\), \({""}\), \({""}\), \({""}\), \({""}\), \({""}\)},
            {\({""}\), \({""}\), \({""}\), \({""}\), 
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule].S*S"\)},
                      {\("S\[Rule].S+S"\)},
                      {\("S\[Rule].a"\)}
                      }], ")"}],
                MatrixForm[ {"S\[Rule].S*S", "S\[Rule].S+S", "S\[Rule].a"}]], 
              
              InterpretationBox[
                RowBox[{"(", GridBox[{
                      {\("S\[Rule]a."\)},
                      {\("S\[Rule]S.*S"\)},
                      {\("S\[Rule]S.+S"\)}
                      }], ")"}],
                MatrixForm[ {"S\[Rule]a.", "S\[Rule]S.*S", "S\[Rule]S.+S"}]]},
            
            {\({""}\), \({""}\), \({""}\), \({""}\), \({""}\), \({""}\)}
            }], ")"}],
      (MatrixForm[ #]&)]], "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["G) PARSING", "Subsection"],

Cell["\<\
With the help of matrix early we generate a right parsing of a given word.\
\>", "Text"],

Cell[BoxData[
    \(\(parse[w_, G_] := 
      Module[{t = earley[w, G], c, par, ans = {}}, \n\t\t\n\t\t
        par[i_, j_, {A_, Apm_}] := 
          Module[{m, j0, n, k, u}, \n\t\t\t\t\t\n\t\t\t\tj0 = j; \n\t\t\t\t
            m = Position[G, {A, StringJoin[Apm]}]; \n\t\t\t\t
            AppendTo[ans, m\[LeftDoubleBracket]1, 1\[RightDoubleBracket]]; \ 
            \n\t\t\t\t\t
            Do[\n\t\t\t\t\t\t
              If\ [Not[
                  UpperCaseQ[Apm\[LeftDoubleBracket]n\[RightDoubleBracket]]], 
                j0 = j0 - 1, \n\t\t\t\t\t\tk = j0; \n\t\t\t\t\t
                While[\n\t\t\t\t\t\t\t
                  Not[\((i \[LessEqual] k)\)\  && \ 
                      \((u = Cases[
                            t\[LeftDoubleBracket]k, j0
                              \[RightDoubleBracket], {
                                Apm\[LeftDoubleBracket]n
                                  \[RightDoubleBracket], {\[Alpha]___, 
                                  "\<.\>"}} 
                              \[Rule] {
                                Apm\[LeftDoubleBracket]n
                                  \[RightDoubleBracket], {\[Alpha]}}]; \ 
                        u \[NotEqual] {})\)\  && \ 
                      MemberQ[
                        t\[LeftDoubleBracket]i, k\[RightDoubleBracket], {A, 
                          Insert[Apm, "\<.\>", n]}]], k = k - 1]; \n
                \t\t\t\t\t\t\tpar[k, j0, First[u]]; \n\t\t\t\t\t\tj0 = k], {
                n, Length[Apm], 1, \(-1\)}]]; \n\t\t\n\t\t\n\t\t
        c = Cases[
            Last[First[t]], {"\<S\>", {\[Alpha]___, "\<.\>"}} 
              \[Rule] {"\<S\>", {\[Alpha]}}]; \n\t\t
        If[c \[NotEqual] {}, \n\t\t\t
          par[1, StringLength[w] + 1, 
            c\[LeftDoubleBracket]1\[RightDoubleBracket]], 
          Return["\<Error\>"]]; \n\t\t\t\t\t\tans]\t\t\n\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(G\_3\), 
    \(parse["\<a+a*a\>", G\_3]\)}], "Input"],

Cell[BoxData[
    \({{"S", "S*S"}, {"S", "S+S"}, {"S", "a"}}\)], "Output"],

Cell[BoxData[
    \({1, 3, 2, 3, 3}\)], "Output"]
}, Closed]],

Cell["\<\
The former parsing corresponds to the right parse: S, S*S, S*a, S+S*a, S+a*a, \
a+a*a\t
\t\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(G\_6\), 
    \(parse["\<abaaabbabb\>", G\_6]\)}], "Input"],

Cell[BoxData[
    \({{"S", "aB"}, {"S", "bA"}, {"A", "a"}, {"A", "aS"}, {"A", "bAA"}, {"B", 
        "b"}, {"B", "bS"}, {"B", "aBB"}}\)], "Output"],

Cell[BoxData[
    \({1, 7, 1, 8, 6, 8, 6, 7, 2, 3}\)], "Output"]
}, Closed]],

Cell["\<\
The former parsing corresponds to the right parse:
\t\t
\t\tS, aB, abS, abaB, abaaBB, abaaaBBb, abaaaBbb, abaaabSbb, abaaabbAbb, \
abaaabbabb\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    \(parse["\<aaabbb\>", G\_5]\)], "Input"],

Cell[BoxData[
    \({1, 1, 1, 2}\)], "Output"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
FrontEndVersion->"Microsoft Windows 3.0",
ScreenRectangle->{{0, 1280}, {0, 996}},
AutoGeneratedPackage->None,
WindowToolbars->"EditBar",
WindowSize->{731, 699},
WindowMargins->{{129, Automatic}, {Automatic, 62}},
StyleDefinitions -> "Report.nb"
]


(***********************************************************************
Cached data follows.  If you edit this Notebook file directly, not using
Mathematica, you must remove the line containing CacheID at the top of 
the file.  The cache data will then be recreated when you save this file 
from within Mathematica.
***********************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1731, 51, 124, 5, 108, "Title"],
Cell[1858, 58, 340, 11, 132, "Subtitle"],
Cell[2201, 71, 873, 24, 257, "Abstract"],
Cell[3077, 97, 588, 15, 267, "Reference"],

Cell[CellGroupData[{
Cell[3690, 116, 48, 0, 70, "Section 1"],
Cell[3741, 118, 1705, 41, 233, "Text"],

Cell[CellGroupData[{
Cell[5471, 163, 187, 6, 42, "Subsection"],
Cell[5661, 171, 386, 7, 135, "Input",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[6072, 182, 78, 1, 35, "Input"],
Cell[6153, 185, 83, 1, 49, "Output"]
}, Closed]],
Cell[6251, 189, 410, 9, 119, "Input",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[6686, 202, 133, 2, 35, "Input"],
Cell[6822, 206, 155, 2, 49, "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[7038, 215, 54, 0, 44, "Section 1"],

Cell[CellGroupData[{
Cell[7117, 219, 127, 3, 41, "Subsection"],
Cell[7247, 224, 694, 22, 55, "Input"],

Cell[CellGroupData[{
Cell[7966, 250, 83, 1, 35, "Input"],
Cell[8052, 253, 102, 2, 49, "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[8203, 261, 92, 2, 25, "Subsection"],
Cell[8298, 265, 186, 3, 55, "Input"],

Cell[CellGroupData[{
Cell[8509, 272, 149, 2, 35, "Input"],
Cell[8661, 276, 149, 2, 49, "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[8859, 284, 148, 3, 44, "Subsection"],
Cell[9010, 289, 423, 8, 215, "Input"],

Cell[CellGroupData[{
Cell[9458, 301, 131, 3, 35, "Input"],
Cell[9592, 306, 275, 4, 68, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[9904, 315, 123, 3, 39, "Input"],
Cell[10030, 320, 220, 3, 68, "Output"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[10311, 330, 40, 0, 44, "Section 1"],
Cell[10354, 332, 496, 11, 80, "Text"],
Cell[10853, 345, 80, 1, 35, "Input"],

Cell[CellGroupData[{
Cell[10958, 350, 85, 1, 35, "Input"],
Cell[11046, 353, 70, 1, 49, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[11153, 359, 342, 10, 27, "Subsection"],
Cell[11498, 371, 701, 13, 215, "Input"],

Cell[CellGroupData[{
Cell[12224, 388, 152, 2, 75, "Input"],
Cell[12379, 392, 394, 10, 107, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[12810, 407, 210, 4, 79, "Input"],
Cell[13023, 413, 553, 12, 123, "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[13625, 431, 131, 3, 25, "Subsection"],
Cell[13759, 436, 1070, 19, 335, "Input"],

Cell[CellGroupData[{
Cell[14854, 459, 53, 1, 35, "Input"],
Cell[14910, 462, 55, 1, 49, "Output"]
}, Closed]],
Cell[14980, 466, 297, 7, 78, "Text"],

Cell[CellGroupData[{
Cell[15302, 477, 53, 1, 35, "Input"],
Cell[15358, 480, 61, 1, 49, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[15456, 486, 237, 4, 79, "Input"],
Cell[15696, 492, 91, 1, 49, "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[15836, 499, 71, 0, 25, "Subsection"],
Cell[15910, 501, 261, 6, 95, "Input"],
Cell[16174, 509, 50, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[16249, 513, 77, 1, 35, "Input"],
Cell[16329, 516, 874, 17, 182, "Output"]
}, Closed]],
Cell[17218, 536, 389, 8, 61, "Text"]
}, Closed]],

Cell[CellGroupData[{
Cell[17644, 549, 179, 3, 44, "Subsection"],
Cell[17826, 554, 220, 4, 55, "Input"],
Cell[18049, 560, 66, 0, 29, "Text"],
Cell[18118, 562, 411, 10, 155, "Input"],

Cell[CellGroupData[{
Cell[18554, 576, 41, 1, 35, "Input"],
Cell[18598, 579, 101, 2, 49, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[18736, 586, 79, 1, 39, "Input"],
Cell[18818, 589, 3569, 70, 638, "Output"]
}, Closed]],
Cell[22402, 662, 58, 0, 27, "Text"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[22509, 668, 44, 0, 44, "Section 1"],
Cell[22556, 670, 585, 13, 80, "Text"],
Cell[23144, 685, 650, 10, 135, "Input"],

Cell[CellGroupData[{
Cell[23819, 699, 219, 6, 101, "Subsection"],
Cell[24041, 707, 459, 8, 155, "Input"],

Cell[CellGroupData[{
Cell[24525, 719, 156, 6, 135, "Input"],
Cell[24684, 727, 39, 1, 49, "Output"],
Cell[24726, 730, 44, 1, 49, "Output"],
Cell[24773, 733, 36, 1, 49, "Output"],
Cell[24812, 736, 54, 1, 49, "Output"],
Cell[24869, 739, 39, 1, 49, "Output"],
Cell[24911, 742, 36, 1, 49, "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[24996, 749, 96, 2, 25, "Subsection"],

Cell[CellGroupData[{
Cell[25117, 755, 570, 11, 101, "Subsubsection"],
Cell[25690, 768, 1163, 20, 279, "Input"],

Cell[CellGroupData[{
Cell[26878, 792, 221, 3, 57, "Input"],
Cell[27102, 797, 67, 1, 49, "Output"],
Cell[27172, 800, 241, 4, 68, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[27450, 809, 121, 2, 41, "Input"],
Cell[27574, 813, 58, 1, 49, "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[27693, 821, 350, 7, 123, "Subsection"],
Cell[28046, 830, 433, 7, 175, "Input"],

Cell[CellGroupData[{
Cell[28504, 841, 57, 1, 35, "Input"],
Cell[28564, 844, 59, 1, 49, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[28660, 850, 558, 12, 95, "Subsubsection"],
Cell[29221, 864, 156, 3, 39, "Input"],

Cell[CellGroupData[{
Cell[29402, 871, 188, 3, 57, "Input"],
Cell[29593, 876, 67, 1, 49, "Output"],
Cell[29663, 879, 241, 4, 68, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[29941, 888, 119, 2, 41, "Input"],
Cell[30063, 892, 58, 1, 49, "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[30182, 900, 71, 0, 25, "Subsection"],

Cell[CellGroupData[{
Cell[30278, 904, 2151, 49, 228, "Subsubsection"],
Cell[32432, 955, 366, 6, 83, "Input"],

Cell[CellGroupData[{
Cell[32823, 965, 421, 7, 97, "Input"],
Cell[33247, 974, 125, 2, 49, "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[33433, 983, 54, 0, 25, "Subsection"],

Cell[CellGroupData[{
Cell[33512, 987, 393, 7, 120, "Subsubsection"],
Cell[33908, 996, 909, 17, 255, "Input"],

Cell[CellGroupData[{
Cell[34842, 1017, 246, 6, 135, "Input"],
Cell[35091, 1025, 39, 1, 49, "Output"],
Cell[35133, 1028, 59, 1, 49, "Output"],
Cell[35195, 1031, 39, 1, 49, "Output"],
Cell[35237, 1034, 59, 1, 49, "Output"],
Cell[35299, 1037, 39, 1, 49, "Output"],
Cell[35341, 1040, 39, 1, 49, "Output"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[35429, 1047, 433, 10, 78, "Subsubsection"],
Cell[35865, 1059, 676, 12, 215, "Input"],

Cell[CellGroupData[{
Cell[36566, 1075, 234, 6, 135, "Input"],
Cell[36803, 1083, 153, 2, 49, "Output"],
Cell[36959, 1087, 205, 3, 68, "Output"],
Cell[37167, 1092, 120, 2, 49, "Output"],
Cell[37290, 1096, 457, 7, 87, "Output"],
Cell[37750, 1105, 77, 1, 49, "Output"],
Cell[37830, 1108, 82, 1, 49, "Output"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{
Cell[37961, 1115, 200, 3, 93, "Subsubsection"],
Cell[38164, 1120, 168, 3, 55, "Input"],

Cell[CellGroupData[{
Cell[38357, 1127, 250, 4, 75, "Input"],
Cell[38610, 1133, 48, 1, 49, "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[38719, 1141, 39, 0, 25, "Subsection"],

Cell[CellGroupData[{
Cell[38783, 1145, 64, 0, 31, "Subsubsection"],
Cell[38850, 1147, 1581, 29, 315, "Input"],
Cell[40434, 1178, 111, 3, 29, "Text"],
Cell[40548, 1183, 140, 3, 55, "Input"],

Cell[CellGroupData[{
Cell[40713, 1190, 337, 7, 95, "Input"],
Cell[41053, 1199, 1228, 31, 171, "Output"]
}, Closed]],

Cell[CellGroupData[{
Cell[42318, 1235, 341, 7, 99, "Input"],
Cell[42662, 1244, 3793, 90, 251, "Output"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[46516, 1341, 32, 0, 25, "Subsection"],
Cell[46551, 1343, 98, 2, 29, "Text"],
Cell[46652, 1347, 1874, 35, 455, "Input"],

Cell[CellGroupData[{
Cell[48551, 1386, 74, 2, 55, "Input"],
Cell[48628, 1390, 74, 1, 49, "Output"],
Cell[48705, 1393, 49, 1, 49, "Output"]
}, Closed]],
Cell[48769, 1397, 114, 4, 44, "Text"],

Cell[CellGroupData[{
Cell[48908, 1405, 79, 2, 55, "Input"],
Cell[48990, 1409, 147, 2, 49, "Output"],
Cell[49140, 1413, 64, 1, 49, "Output"]
}, Closed]],
Cell[49219, 1417, 165, 5, 61, "Text"],

Cell[CellGroupData[{
Cell[49409, 1426, 58, 1, 35, "Input"],
Cell[49470, 1429, 46, 1, 49, "Output"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)




(***********************************************************************
End of Mathematica Notebook file.
***********************************************************************)

